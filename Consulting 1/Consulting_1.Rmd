---
title: "CS 644 Assignment 1"
author: "Prithwish Ganguly pg422"
date: "February 25, 2019"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
df <- read.csv("data.csv")
attach(df)
```

# Question 1

```{r}
lm.fit1 <- lm(log(C)~D+log(T2)+log(S)+PR+NE+CT+log(N)+PT)
summary(lm.fit1)
```

Estimate for PT: -0.21451
Standard error for PT: 0.12229

Nuclear plants with partial turnkey guarantee cost 0.21451 less than those that do not have the guarantee.

# Question 2

```{r}
lmreduced.fit<- lm(log(C)~PT+CT+log(N)+log(S)+D+NE)
summary(lmreduced.fit)
```

# Question 3

## Part a

```{r}
lm.resid = resid(lmreduced.fit)
plot(fitted(lmreduced.fit), lm.resid, xlab = "Fitted Values", 
     ylab = "Residuals", main = "Residuals vs Fitted Values")
abline(a = 0, b = 0, lty = 2)
```

## Part b

```{r}

plot(log(df$N), lm.resid, xlab = "log N", ylab = "Residuals", 
     main = "Residuals vs log N")
abline(a = 0, b = 0, lty = 2)
```

## Part c

```{r}
qqnorm(y=lm.resid, main = "Residuals vs Normal Order Statistics",
       xlab = "Normal Order Statistics", ylab = "Residuals")
abline(a = 0, b = 0, lty = 28)
```

# Question 4

Residuals vs Fitted values - This checks for the assumption that the relationship is linear and also appears if the data appears homoscedatic. When this assumption is guaranteed, the residuals are grouped around the 0 line. If the data is homoscedatic, the points are scattered randomly around the x-axis. If they are not, e.g. if they form a curve, bowtie etc., then data doesn't meet the assumption.

Residuals vs log N - This checks for outliers generated by the log N variable in particular. The assumption being made here is that the relationship between residuals and log N in particular is also linear and this can be observed by the fact that, that points are grouped randomly around the 0 line as observed here.

Residuals vs Normal Order Statistics - This checks if the residuals are normally distributed. When this assumption is guaranteed, the data points closely follows a straight line at a 45% angle upwards(left to right).


The above plots also help us look for outliers which are points that are futher away from other points.
# Question 5

```{r}
Z = log(S)
lmreduced.fit2<- lm(log(C)~PT+CT+log(N)+log(S)+D+NE+I(PT*Z))
summary(lmreduced.fit2)
```

# References

Applied Statistics, Principles and Examples by D. R. Cox & E. J. Snell